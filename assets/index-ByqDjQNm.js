import{b as e,r as s,j as a,a as t,m as l,ax as r,ay as i,az as n,e as o,U as c,R as d}from"./index-CxscT09Y.js";import{V as m,O as x}from"./index-Dg0Qh9jE.js";import{T as u}from"./ThemeToggle-BS9HM_JZ.js";import{P as b}from"./PageHeader-BfEO0UN-.js";import{X as p,U as f,K as g,e as h,T as j}from"./x-C-WXaDeE.js";import{I as y}from"./zap-C1hV3rjf.js";import{aq as N,E as w,t as k,aE as v,aj as C,aF as z,aG as S,n as P,B as U,ai as A}from"./lucide-react-Dm8ijxDf.js";import{L}from"./zoom-out-BkmDqjxf.js";import"./useDarkMode-uytT8DPn.js";import"./index-C08PnImj.js";const E=({value:e,onChange:t,placeholder:l,id:r})=>{const[i,n]=s.useState(!1);return a.jsxs("div",{className:"relative",children:[a.jsx("input",{id:r,type:i?"text":"password",value:e,onChange:t,className:"input-style w-full pr-10",placeholder:l,autoComplete:"new-password"}),a.jsx("button",{type:"button",onClick:()=>n(!i),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-slate-400",children:i?a.jsx(N,{size:16}):a.jsx(w,{size:16})})]})},F=({isOpen:i,onClose:n})=>{const{logout:o}=e(),[c,d]=s.useState(""),[x,u]=s.useState(""),[b,f]=s.useState(""),[g,h]=s.useState(!1),j=()=>{d(""),u(""),f(""),h(!1),n()};return i?a.jsx(t,{children:a.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[a.jsx(l.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-black/60",onClick:j}),a.jsxs(l.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},exit:{opacity:0,y:30},className:"relative bg-white dark:bg-slate-800 w-full max-w-md rounded-xl shadow-xl flex flex-col",children:[a.jsxs("header",{className:"p-5 border-b border-slate-200 dark:border-slate-700 flex justify-between items-center",children:[a.jsx("h2",{className:"text-lg font-semibold text-slate-800 dark:text-white",children:"Change Password"}),a.jsx("button",{onClick:j,className:"p-1 rounded-full hover:bg-slate-100 dark:hover:bg-slate-700",children:a.jsx(p,{size:18})})]}),a.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),x!==b)return void m.error("New passwords do not match.");if(x.length<8)return void m.error("New password must be at least 8 characters long.");h(!0);const s=m.loading("Updating password...");try{await r({currentPassword:c,newPassword:x}),m.success("Password updated! Logging you out for security...",{id:s,duration:4e3}),setTimeout(()=>{o()},1500)}catch(a){m.error(a.message||"Failed to update password.",{id:s}),h(!1)}},className:"p-6 space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"label-style",htmlFor:"currentPass",children:"Current Password"}),a.jsx(E,{id:"currentPass",value:c,onChange:e=>d(e.target.value),placeholder:"••••••••"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"label-style",htmlFor:"newPass",children:"New Password"}),a.jsx(E,{id:"newPass",value:x,onChange:e=>u(e.target.value),placeholder:"New strong password"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"label-style",htmlFor:"confirmPass",children:"Confirm New Password"}),a.jsx(E,{id:"confirmPass",value:b,onChange:e=>f(e.target.value),placeholder:"Confirm new password"})]}),a.jsxs("div",{className:"flex items-start p-3 mt-2 text-sm text-sky-800 bg-sky-50 dark:bg-slate-700/80 dark:text-sky-300 rounded-lg",children:[a.jsx(y,{size:20,className:"mr-2.5 mt-0.5 flex-shrink-0"}),a.jsx("span",{children:"For your security, you will be logged out and asked to sign in again after changing your password."})]}),a.jsxs("div",{className:"pt-2 flex justify-end gap-3",children:[a.jsx("button",{type:"button",onClick:j,className:"btn-outline-style text-sm",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:g,className:"btn-primary-style text-sm",children:g?"Updating...":"Update Password & Log Out"})]})]})]})]})}):null},O=({user:e,onUpdate:t,currentUser:l})=>{const[r,i]=s.useState(!1),o="suspended"===e.status,c="superadmin"===e.role||e._id===l.id,d="admin"===e.role;return a.jsxs("div",{className:"flex items-center justify-between p-3 hover:bg-slate-100 dark:hover:bg-slate-700/50 rounded-lg transition-colors duration-200",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("img",{src:e.avatar||`https://ui-avatars.com/api/?name=${e.name.replace(" ","+")}&background=random`,alt:e.name,className:"w-10 h-10 rounded-full"}),a.jsxs("div",{children:[a.jsxs("p",{className:"font-semibold text-slate-800 dark:text-slate-100 flex items-center gap-2",children:[e.name,e._id===l.id&&a.jsx("span",{className:"text-xs text-sky-500",children:"(You)"})]}),a.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:e.email})]})]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("span",{className:"flex items-center gap-1.5 px-2 py-1 text-xs font-semibold rounded-full capitalize "+(d?"bg-amber-100 text-amber-700 dark:bg-amber-900/50 dark:text-amber-300":"bg-slate-100 text-slate-600 dark:bg-slate-700 dark:text-slate-300"),children:[d&&a.jsx(C,{size:12}),e.role]}),a.jsx("button",{onClick:async()=>{i(!0);const s=o?"active":"suspended",a=o?"Unlocking":"Locking",l=m.loading(`${a} user...`);try{await n(e._id,s),m.success(`User successfully ${a.toLowerCase().slice(0,-3)}ed.`,{id:l}),t()}catch(r){m.error(r.message||`Failed to ${a.toLowerCase()} user.`,{id:l})}finally{i(!1)}},disabled:r||c,className:"p-2 rounded-full text-slate-500 hover:bg-slate-200 dark:hover:bg-slate-600 disabled:opacity-40 disabled:cursor-not-allowed transition-colors",title:c?"Action not permitted":o?"Unlock User":"Lock User Account",children:r?a.jsx(k,{size:18,className:"animate-spin"}):o?a.jsx(z,{size:18,className:"text-green-500"}):a.jsx(L,{size:18,className:"text-red-500"})})]})]})},T=({isOpen:r,onClose:n})=>{const{user:o}=e(),[c,d]=s.useState([]),[x,u]=s.useState(!1),[b,g]=s.useState(null),h=s.useCallback(async()=>{u(!0),g(null);try{const e=await i();if(!e||!e.owner)throw new Error("Invalid organization data received.");{const s=e.owner,a=Array.isArray(e.members)?e.members:[];d([s,...a])}}catch(e){g(e.message||"Could not fetch team data."),m.error(e.message||"Could not fetch team data.")}finally{u(!1)}},[]);return s.useEffect(()=>{r&&h()},[r,h]),r?a.jsx(t,{children:a.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[a.jsx(l.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-black/60",onClick:n}),a.jsxs(l.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},exit:{opacity:0,y:30},className:"relative bg-white dark:bg-slate-800 w-full max-w-2xl rounded-xl shadow-xl flex flex-col max-h-[90vh]",children:[a.jsxs("header",{className:"p-5 border-b border-slate-200 dark:border-slate-700 flex justify-between items-center sticky top-0 bg-white/80 dark:bg-slate-800/80 backdrop-blur-sm",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(f,{className:"mr-3 text-sky-500",size:22}),a.jsx("h2",{className:"text-lg font-semibold text-slate-800 dark:text-white",children:"Manage Team"})]}),a.jsx("button",{onClick:n,className:"p-1 rounded-full hover:bg-slate-100 dark:hover:bg-slate-700",children:a.jsx(p,{size:18})})]}),a.jsx("div",{className:"p-6 space-y-4 overflow-y-auto",children:x?a.jsx("div",{className:"flex justify-center items-center p-10",children:a.jsx(k,{className:"animate-spin text-sky-500",size:32})}):b?a.jsxs("div",{className:"flex flex-col items-center text-center p-10 text-red-500",children:[a.jsx(v,{size:40,className:"mb-2"}),a.jsx("p",{className:"font-semibold",children:"Error Loading Team"}),a.jsx("p",{className:"text-sm",children:b})]}):a.jsx("div",{className:"space-y-2",children:c.map(e=>a.jsx(O,{user:e,onUpdate:h,currentUser:o},e._id))})})]})]})}):null},D=({title:e,icon:s,children:t,className:r="",delay:i=0})=>a.jsxs(l.div,{initial:{opacity:0,y:40},animate:{opacity:1,y:0},transition:{duration:.5,delay:.08*i,ease:[.25,1,.5,1]},whileHover:{y:-8,scale:1.03,boxShadow:"0 20px 30px -10px rgba(0, 0, 0, 0.15)"},className:`bg-white dark:bg-slate-800 shadow-lg rounded-xl border border-slate-200/80 dark:border-slate-700/50 flex flex-col ${r}`,style:{perspective:"1000px"},children:[a.jsx("div",{className:"p-6 border-b border-slate-200/80 dark:border-slate-700/50",children:a.jsxs("div",{className:"flex items-center text-slate-800 dark:text-slate-200",children:[d.cloneElement(s,{size:20,className:"mr-3 text-sky-500"}),a.jsx("h3",{className:"text-lg font-semibold",children:e})]})}),a.jsx("div",{className:"p-6 flex-grow flex flex-col",children:t})]}),B=({label:e,enabled:s,setEnabled:t})=>a.jsxs("div",{className:"flex items-center justify-between py-3",children:[a.jsx("span",{className:"font-medium text-slate-700 dark:text-slate-300",children:e}),a.jsx("button",{onClick:()=>t(!s),className:(s?"bg-sky-500":"bg-slate-300 dark:bg-slate-600")+" relative inline-flex items-center h-6 rounded-full w-11 transition-colors focus:outline-none focus:ring-2 focus:ring-sky-500 focus:ring-offset-2 focus:ring-offset-white dark:focus:ring-offset-slate-900",role:"switch","aria-checked":s,children:a.jsx("span",{className:(s?"translate-x-6":"translate-x-1")+" inline-block w-4 h-4 transform bg-white rounded-full transition-transform duration-200 ease-in-out"})})]}),I=({label:e,value:s})=>a.jsxs("div",{className:"flex items-center justify-between py-2 text-sm",children:[a.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:e}),a.jsx("p",{className:"font-semibold text-slate-800 dark:text-slate-100",children:s})]}),M=()=>{const{user:t,subscriptionInfo:l,logout:r}=e(),i=o(),[n,d]=s.useState(!1),[m,p]=s.useState(!1),[f,y]=s.useState({emailNotifications:!0,inAppNotifications:!0});if(!t||!l)return a.jsx("div",{className:"bg-slate-100 dark:bg-slate-900 min-h-screen flex items-center justify-center text-slate-500",children:"Loading Settings..."});const N=l.subscription?.plan?.name||"Free Tier",w=l.subscription?.nextBillingDate?new Date(l.subscription.nextBillingDate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A",k="admin"===t.role||"superadmin"===t.role;return a.jsxs(a.Fragment,{children:[a.jsx(x,{position:"top-center",toastOptions:{className:"dark:bg-slate-700 dark:text-white"}}),a.jsx(F,{isOpen:n,onClose:()=>d(!1)}),k&&a.jsx(T,{isOpen:m,onClose:()=>p(!1)}),a.jsxs("div",{children:[a.jsx(b,{title:"Settings",subtitle:"Manage your application preferences and account settings.",iconName:"SettingsIcon"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[a.jsxs(D,{title:"Account",icon:a.jsx(c,{}),delay:0,children:[a.jsxs("div",{className:"space-y-2 flex-grow",children:[a.jsx(I,{label:"Username",value:t.username||t.name.toLowerCase().replace(" ","_")}),a.jsx(I,{label:"Email",value:t.email})]}),a.jsxs("button",{onClick:r,className:"group btn-secondary w-full mt-4 text-sm",children:[a.jsx(S,{size:16,className:"mr-2"})," Log Out"]})]}),a.jsxs(D,{title:"Appearance",icon:a.jsx(P,{}),delay:1,children:[a.jsxs("div",{className:"flex items-center justify-between py-3",children:[a.jsx("span",{className:"font-medium text-slate-700 dark:text-slate-300",children:"Theme"}),a.jsx(u,{})]}),a.jsxs("div",{className:"py-3 border-t border-slate-200 dark:border-slate-700",children:[a.jsx("label",{htmlFor:"language",className:"font-medium text-slate-700 dark:text-slate-200",children:"Language"}),a.jsx("p",{className:"text-xs text-slate-500 mb-2",children:"Interface language."}),a.jsx("select",{id:"language",className:"input-style w-full",children:a.jsx("option",{children:"English (US)"})})]})]}),a.jsx(D,{title:"Notifications",icon:a.jsx(U,{}),delay:2,children:a.jsxs("div",{className:"space-y-1 divide-y divide-slate-200 dark:divide-slate-700",children:[a.jsx(B,{label:"Email Notifications",enabled:f.emailNotifications,setEnabled:e=>y(s=>({...s,emailNotifications:e}))}),a.jsx(B,{label:"In-App Notifications",enabled:f.inAppNotifications,setEnabled:e=>y(s=>({...s,inAppNotifications:e}))})]})}),a.jsx(D,{title:"Security",icon:a.jsx(L,{}),delay:3,children:a.jsx("div",{className:"flex-grow py-3",children:a.jsxs("button",{className:"btn-outline-style w-full",onClick:()=>d(!0),children:[a.jsx(g,{size:16,className:"mr-2"}),"Change Password"]})})}),a.jsxs(D,{title:"Billing",icon:a.jsx(A,{}),delay:4,children:[a.jsxs("div",{className:"flex-grow space-y-2",children:[a.jsx(I,{label:"Current Plan",value:N}),a.jsx(I,{label:"Next Billing Date",value:w})]}),a.jsx("button",{className:"btn-primary-style w-full mt-4",onClick:()=>i("/subscriptions"),children:"Manage Subscription"})]}),k&&a.jsxs(D,{title:"Organization",icon:a.jsx(h,{}),delay:5,children:[a.jsxs("div",{className:"flex-grow space-y-2",children:[a.jsx(I,{label:"Org Name",value:t.organization?.name||"N/A"}),a.jsx(I,{label:"Your Role",value:t.role})]}),a.jsx("button",{className:"btn-outline-style w-full mt-4",onClick:()=>p(!0),children:"Manage Team"})]}),a.jsxs(D,{title:"Danger Zone",icon:a.jsx(v,{}),delay:6,children:[a.jsx("div",{className:"flex-grow flex flex-col justify-center",children:a.jsx("p",{className:"text-center text-sm text-slate-500 dark:text-slate-400",children:"Be careful, these actions are permanent."})}),a.jsxs("button",{className:"group btn-danger w-full mt-4",children:[a.jsx(j,{size:16,className:"mr-2"})," Delete Account"]})]})]}),a.jsx("style",{children:"\n                    .input-style { display: block; width: 100%; padding: 0.65rem 0.75rem; font-size: 0.875rem; color: #334155; background-color: #f1f5f9; border: 1px solid #e2e8f0; border-radius: 0.5rem; transition: all 0.2s; }\n                    .dark .input-style { background-color: #1e293b; color: #e2e8f0; border-color: #334155; }\n                    .input-style:focus { border-color: #38bdf8; outline: 0; box-shadow: 0 0 0 3px rgb(56 189 248 / 0.25); }\n\n                    .btn-primary-style { display: inline-flex; align-items: center; justify-content: center; padding: 0.65rem 1.25rem; font-size: 0.875rem; font-weight: 600; border-radius: 0.5rem; color: white; background-image: linear-gradient(to right, #0ea5e9, #6366f1); transition: all 0.2s; box-shadow: 0 4px 15px -5px rgb(14 165 233 / 50%); }\n                    .btn-primary-style:hover:not(:disabled) { filter: brightness(1.1); transform: translateY(-2px); }\n                    .btn-primary-style:disabled { opacity: 0.6; cursor: not-allowed; }\n                    \n                    .btn-outline-style { display: inline-flex; align-items: center; justify-content: center; padding: 0.65rem 1.25rem; font-size: 0.875rem; font-weight: 500; border-radius: 0.5rem; color: #0ea5e9; background-color: transparent; border: 1px solid #38bdf8; transition: all 0.2s; }\n                    .dark .btn-outline-style { color: #38bdf8; border-color: #38bdf8; }\n                    .btn-outline-style:hover { background-color: #e0f2fe; color: #0284c7; }\n                    .dark .btn-outline-style:hover { background-color: #0ea5e920; }\n\n                    .btn-secondary { display: inline-flex; align-items: center; justify-content: center; padding: 0.5rem 1rem; font-size: 0.875rem; font-weight: 600; border-radius: 0.5rem; color: #475569; background-color: #e2e8f0; border: 1px solid #e2e8f0; transition: all 0.2s; }\n                    .dark .btn-secondary { color: #cbd5e1; background-color: #334155; border-color: #475569; }\n                    .dark .btn-secondary:hover { background-color: #475569; color: #fff; }\n                    \n                    .btn-danger { display: inline-flex; align-items: center; justify-content: center; padding: 0.65rem 1.25rem; font-size: 0.875rem; font-weight: 500; border-radius: 0.5rem; color: #f87171; background-color: transparent; border: 1px solid #ef444480; transition: all 0.2s; }\n                    .btn-danger:hover { background-color: #ef444420; color: #ef4444; border-color: #ef4444; }\n\n                    .label-style { display: block; margin-bottom: 0.5rem; font-size: 0.875rem; font-weight: 500; color: #475569; }\n                    .dark .label-style { color: #cbd5e1; }\n                "})]})]})};export{M as default};
