import{r as e,j as s,m as a,a as t,b as l,an as r,ao as i,ap as n,aq as d,ar as o,as as c,at as x,au as m,P as p,av as u,R as b}from"./index-CxscT09Y.js";import{V as g,O as h}from"./index-Dg0Qh9jE.js";import{u as f}from"./useDarkMode-uytT8DPn.js";import{F as j}from"./FallbackAvatar-P-4t8Jcq.js";import{e as k,S as y,a as v,X as N,f as w,g as C,K as z,T as P,d as A,c as S,h as M,P as _,C as U,U as O,D,i as $,j as L}from"./x-C-WXaDeE.js";import{Z as R,A as E,I as F}from"./zap-C1hV3rjf.js";import{f as I}from"./format-DhIoevPb.js";import{P as T}from"./PaymentModal-BQ985snT.js";import"./en-US-DXcIbJEK.js";import"./index-C08PnImj.js";import"./server.browser-BDVDZUy1.js";const B=e=>s.jsxs("span",{className:`px-2.5 py-1 inline-flex text-xs leading-5 font-semibold rounded-full items-center gap-1.5 ${{active:"bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-300",inactive:"bg-slate-100 text-slate-700 dark:bg-slate-700 dark:text-slate-300",suspended:"bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-300",pending_acceptance:"bg-amber-100 text-amber-800 dark:bg-amber-800/50 dark:text-amber-300"}[e]||"bg-gray-100 text-gray-800"}`,children:["pending_acceptance"===e&&s.jsx(M,{size:12}),e.replace("_"," ")]}),Y=e=>s.jsxs("span",{className:`px-3 py-1.5 inline-flex items-center gap-1.5 text-xs font-bold rounded-full ${{admin:"bg-purple-100 text-purple-800 dark:bg-purple-900/50 dark:text-purple-300",owner:"bg-amber-100 text-amber-800 dark:bg-amber-900/50 dark:text-amber-300",user:"bg-sky-100 text-sky-800 dark:bg-sky-900/50 dark:text-sky-300",superadmin:"bg-rose-100 text-rose-800 dark:bg-rose-900/50 dark:text-rose-300"}[e]||"bg-gray-100 text-gray-800"}`,children:["admin"===e||"superadmin"===e?s.jsx(A,{size:14}):"owner"===e?s.jsx(S,{size:14}):null,e]}),V=({user:e,onClose:n,onUserUpdate:d})=>{const{user:o}=l();if(!e)return null;const c="superadmin"===o.role||"admin"===o.role&&o.organization?._id===e.organization?._id,x=o._id===e._id,m="superadmin"===e.role,p=!c||x||m;return s.jsx(t,{children:s.jsxs("div",{className:"fixed inset-0 z-[101] flex items-center justify-center p-4",children:[s.jsx(a.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:n,className:"absolute inset-0 bg-black/70 backdrop-blur-md"}),s.jsxs(a.div,{initial:{y:20,scale:.95,opacity:0},animate:{y:0,scale:1,opacity:1},exit:{y:20,scale:.95,opacity:0},transition:{type:"spring",stiffness:400,damping:30},className:"relative z-10 w-full max-w-4xl bg-slate-50 dark:bg-slate-900 rounded-2xl shadow-2xl flex flex-col md:flex-row overflow-hidden border border-slate-200 dark:border-slate-800",children:[s.jsx("button",{onClick:n,className:"absolute top-3 right-3 p-2 rounded-full hover:bg-slate-200/70 dark:hover:bg-slate-700 transition-colors z-20",children:s.jsx(N,{size:20,className:"text-slate-600 dark:text-slate-300"})}),s.jsxs("div",{className:"w-full md:w-1/2 p-8 flex flex-col items-center justify-center text-center border-b md:border-b-0 md:border-r border-slate-200 dark:border-slate-800 bg-white/50 dark:bg-slate-800/20",children:[s.jsx(j,{name:e.name,size:"h-28 w-28",className:"mb-4 border-4 border-white dark:border-slate-700 shadow-lg"}),s.jsx("h2",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:e.name}),s.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-4",children:e.email}),s.jsxs("div",{className:"flex items-center gap-4",children:[Y(e.role),B(e.status)]}),s.jsxs("div",{className:"text-xs text-slate-400 dark:text-slate-500 mt-6",children:["Member since"," ",e.createdAt?I(new Date(e.createdAt),"MMMM d, yyyy"):"N/A"]})]}),s.jsxs("div",{className:"w-full md:w-1/2 p-8 flex flex-col justify-center",children:[s.jsx("h3",{className:"text-lg font-bold text-slate-700 dark:text-slate-200 mb-4",children:"Management Actions"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("button",{disabled:p||!["active","inactive"].includes(e.status),onClick:async()=>{const s="active"===e.status?"Deactivating":"Activating",a=g.loading(`${s} ${e.name}...`);try{const{user:s,message:t}=await r(e._id);g.success(t,{id:a}),d(s),n()}catch(t){g.error(t.message||"Action failed.",{id:a})}},className:"w-full flex items-center p-4 rounded-lg font-semibold text-sm transition-colors border disabled:opacity-50 disabled:cursor-not-allowed bg-white dark:bg-slate-800/50 border-slate-200 dark:border-slate-700 hover:bg-slate-100 dark:hover:bg-slate-800",children:["active"===e.status?s.jsx(w,{size:20,className:"mr-3 text-red-500"}):s.jsx(C,{size:20,className:"mr-3 text-green-500"}),s.jsxs("div",{className:"text-left",children:[s.jsxs("p",{className:"text-slate-800 dark:text-slate-100",children:["active"===e.status?"Deactivate":"Activate"," User"]}),s.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Toggle user's access to the platform."})]})]}),s.jsxs("button",{disabled:p,onClick:async()=>{const s=g.loading(`Sending reset link to ${e.name}...`);try{const{message:a}=await i(e._id);g.success(a,{id:s})}catch(a){g.error(a.message||"Failed to send link.",{id:s})}},className:"w-full flex items-center p-4 rounded-lg font-semibold text-sm transition-colors border disabled:opacity-50 disabled:cursor-not-allowed bg-white dark:bg-slate-800/50 border-slate-200 dark:border-slate-700 hover:bg-slate-100 dark:hover:bg-slate-800",children:[s.jsx(z,{size:20,className:"mr-3 text-sky-500"}),s.jsxs("div",{className:"text-left",children:[s.jsx("p",{className:"text-slate-800 dark:text-slate-100",children:"Send Password Reset"}),s.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Email a secure link to reset password."})]})]}),s.jsxs("button",{disabled:p,onClick:async()=>{g.error(`Delete functionality for ${e.name} is not yet implemented.`)},className:"w-full flex items-center p-4 rounded-lg font-semibold text-sm transition-colors border disabled:opacity-50 disabled:cursor-not-allowed bg-white dark:bg-slate-800/50 border-red-500/20 dark:border-red-500/20 hover:bg-red-500/5 dark:hover:bg-red-500/10",children:[s.jsx(P,{size:20,className:"mr-3 text-red-600 dark:text-red-500"}),s.jsxs("div",{className:"text-left",children:[s.jsx("p",{className:"text-red-700 dark:text-red-400",children:"Delete User"}),s.jsx("p",{className:"text-xs text-red-600/80 dark:text-red-400/80",children:"Permanently remove from system."})]})]})]}),p&&s.jsx("p",{className:"text-xs text-center text-slate-500 dark:text-slate-400 mt-4",children:x?"You cannot manage your own account.":m?"A superadmin cannot be managed.":"You do not have permission for this action."})]})]})]})})},q=({user:e,onActionClick:t})=>s.jsxs(a.div,{layout:!0,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0,transition:{duration:.1}},className:"grid grid-cols-10 gap-4 items-center py-3.5 px-4 hover:bg-slate-100 dark:hover:bg-slate-800/50 transition-colors",children:[s.jsxs("div",{className:"col-span-10 sm:col-span-4 flex items-center gap-4",children:[s.jsx(j,{name:e.name,size:"h-10 w-10"}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-semibold text-slate-800 dark:text-slate-100",children:e.name}),s.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:e.email})]})]}),s.jsx("div",{className:"col-span-5 sm:col-span-2 text-sm capitalize",children:Y(e.role)}),s.jsx("div",{className:"col-span-5 sm:col-span-2",children:B(e.status)}),s.jsx("div",{className:"col-span-10 sm:col-span-2 flex justify-start sm:justify-end",children:s.jsx("button",{onClick:()=>t(e),title:"Manage User",className:"p-2 rounded-lg hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-500 dark:text-slate-400 hover:text-cyan-500 transition-colors",children:s.jsx(k,{size:16})})})]}),H=({org:e,isExpanded:l,onToggle:r,onUserAction:i})=>s.jsxs(a.div,{layout:!0,className:"bg-white/50 dark:bg-slate-800/40 rounded-xl border border-slate-200 dark:border-slate-700/80 overflow-hidden",children:[s.jsxs("div",{className:"grid grid-cols-10 gap-4 items-center p-4 cursor-pointer",onClick:r,children:[s.jsx("div",{className:"col-span-10 sm:col-span-4 font-bold text-slate-800 dark:text-slate-100",children:e.name}),s.jsxs("div",{className:"col-span-5 sm:col-span-3 flex items-center text-sm font-semibold text-cyan-600 dark:text-cyan-400",children:[s.jsx(R,{size:16,className:"mr-2 shrink-0"})," ",e.subscription?.plan?.name||"Free"," Plan"]}),s.jsxs("div",{className:"col-span-5 sm:col-span-3 flex justify-end items-center gap-4",children:[s.jsxs("div",{className:"flex -space-x-2",children:[e.users.slice(0,4).map(e=>s.jsx(j,{name:e.name,size:"h-8 w-8"},e._id)),e.users.length>4&&s.jsxs("div",{className:"w-8 h-8 rounded-full bg-slate-200 dark:bg-slate-700 flex items-center justify-center text-xs font-semibold text-slate-600 dark:text-slate-300 border-2 border-white dark:border-slate-800",children:["+",e.users.length-4]})]}),s.jsx(v,{size:20,className:"text-slate-400 dark:text-slate-500 transition-transform "+(l?"rotate-90":"")})]})]}),s.jsx(t,{children:l&&s.jsx(a.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"bg-slate-50 dark:bg-slate-900/30 divide-y divide-slate-100 dark:divide-slate-800/50",children:e.users.map(e=>s.jsx(q,{user:e,onActionClick:i},e._id))})})]}),W=({users:t,onUsersUpdate:l})=>{const[r,i]=e.useState(""),[n,d]=e.useState(null),[o,c]=e.useState(new Set),x=e.useMemo(()=>{if(!Array.isArray(t)||0===t.length)return[];const e=t.reduce((e,s)=>{if(!s.organization)return e;const a=s.organization._id;return e[a]||(e[a]={id:a,name:s.organization.name,subscription:s.organization.subscription,users:[]}),e[a].users.push(s),e},{});let s=Object.values(e).sort((e,s)=>e.name.localeCompare(s.name));if(r){const e=r.toLowerCase();s=s.map(s=>{const a=s.users.filter(s=>s.name.toLowerCase().includes(e)||s.email.toLowerCase().includes(e));return s.name.toLowerCase().includes(e)||s.subscription?.plan?.name.toLowerCase().includes(e)||a.length>0?{...s,users:a.length>0?a:s.users}:null}).filter(Boolean)}return s},[t,r]),m=e.useCallback(e=>{c(s=>{const a=new Set(s);return a.has(e)?a.delete(e):a.add(e),a})},[]);return s.jsxs(s.Fragment,{children:[s.jsxs(a.section,{initial:{opacity:0},animate:{opacity:1},className:"p-4 sm:p-6 rounded-2xl bg-white/60 dark:bg-slate-800/50 border border-slate-200/70 dark:border-white/10",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 gap-4",children:[s.jsxs("h2",{className:"text-2xl font-bold text-slate-800 dark:text-white flex items-center gap-3",children:[s.jsx(k,{size:28,className:"text-cyan-500"}),s.jsx("span",{children:t.length>1?"Organization Members":"User Management"})]}),s.jsxs("div",{className:"relative w-full sm:w-auto",children:[s.jsx(y,{size:18,className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400 dark:text-slate-500"}),s.jsx("input",{type:"text",placeholder:"Search users, orgs, plans...",className:"w-full sm:w-72 py-2.5 pl-11 pr-4 bg-white/50 dark:bg-slate-900/50 text-slate-800 dark:text-slate-200 rounded-lg border border-slate-300 dark:border-slate-700 focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 transition",value:r,onChange:e=>i(e.target.value)})]})]}),s.jsx("div",{className:"space-y-4",children:x.length>0?x.map(e=>s.jsx(H,{org:e,isExpanded:o.has(e.id),onToggle:()=>m(e.id),onUserAction:d},e.id)):s.jsx("div",{className:"text-center py-12",children:s.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"No matching organizations or users found."})})})]}),s.jsx(V,{user:n,onClose:()=>d(null),onUserUpdate:e=>{const s=t.map(s=>s._id===e._id?e:s);l(s)}})]})},K=()=>s.jsx("div",{className:"p-4 sm:p-6 md:p-8 bg-slate-50 dark:bg-slate-900 min-h-screen animate-pulse",children:s.jsxs("div",{className:"mx-auto",children:[s.jsxs("div",{className:"text-center flex flex-col items-center space-y-6 mb-12",children:[s.jsx("div",{className:"h-12 w-3/4 bg-slate-200 dark:bg-slate-700 rounded-lg"}),s.jsx("div",{className:"h-6 w-1/2 bg-slate-200 dark:bg-slate-700 rounded-lg"}),s.jsx("div",{className:"h-12 w-64 bg-slate-200 dark:bg-slate-700 rounded-full"})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 mb-12",children:[...Array(4)].map((e,a)=>s.jsx("div",{className:"h-96 bg-slate-200 dark:bg-slate-700 rounded-2xl",children:s.jsxs("div",{className:"p-8 space-y-6",children:[s.jsx("div",{className:"h-8 w-1/2 mx-auto bg-slate-300 dark:bg-slate-600 rounded"}),s.jsx("div",{className:"h-16 w-1/3 mx-auto bg-slate-300 dark:bg-slate-600 rounded"}),s.jsxs("div",{className:"space-y-3 pt-4",children:[s.jsx("div",{className:"h-4 w-full bg-slate-300 dark:bg-slate-600 rounded"}),s.jsx("div",{className:"h-4 w-5/6 bg-slate-300 dark:bg-slate-600 rounded"}),s.jsx("div",{className:"h-4 w-full bg-slate-300 dark:bg-slate-600 rounded"})]}),s.jsx("div",{className:"h-12 w-full mt-6 bg-slate-300 dark:bg-slate-600 rounded-lg"})]})},a))}),s.jsxs("div",{className:"mt-12",children:[s.jsxs("div",{className:"flex justify-between items-center mb-6",children:[s.jsx("div",{className:"h-8 w-1/4 bg-slate-200 dark:bg-slate-700 rounded-lg"}),s.jsx("div",{className:"h-10 w-64 bg-slate-200 dark:bg-slate-700 rounded-lg"})]}),s.jsx("div",{className:"h-96 w-full bg-slate-200 dark:bg-slate-700 rounded-xl"})]})]})}),X=({period:e,onToggle:a})=>s.jsxs("div",{className:"relative self-center flex items-center p-1 bg-slate-200/70 dark:bg-slate-800/50 rounded-full font-semibold border border-slate-300 dark:border-slate-700",children:[s.jsx("button",{onClick:()=>a("monthly"),className:"px-6 py-2 rounded-full text-sm transition-colors "+("monthly"===e?"bg-white dark:bg-slate-700 text-cyan-600 dark:text-cyan-400 shadow":"text-slate-600 dark:text-slate-300"),children:"Monthly"}),s.jsx("button",{onClick:()=>a("annual"),className:"px-6 py-2 rounded-full text-sm transition-colors "+("annual"===e?"bg-white dark:bg-slate-700 text-cyan-600 dark:text-cyan-400 shadow":"text-slate-600 dark:text-slate-300"),children:"Annual"}),s.jsx("div",{className:"absolute -top-2 -right-2 transform translate-x-1/4 -translate-y-1/4",children:s.jsxs("span",{className:"text-xs font-bold bg-red-500 text-white px-2 py-0.5 rounded-full shadow-lg",children:["Save ",10,"%"]})})]}),Z=({plan:e,onInfoClick:t,isCurrent:l,userRole:r,onSelect:i,pricingPeriod:n,annualDiscount:d,isPopular:o,inModal:c=!1})=>{const x="annual"===n,m=e.priceMonthly,p=m>0?12*m*(1-d/100):0,u=x?p>0?p/12:0:m,b=e.priceMonthly>0?"/mo":"",g="superadmin"===r?{text:"Managed by Superadmin",disabled:!0,className:"bg-slate-300 dark:bg-slate-700/50 text-slate-500 cursor-default"}:l?{text:"Current Plan",disabled:!0,className:"bg-slate-300 dark:bg-slate-700/50 text-slate-500 cursor-default"}:"admin"===r?{text:"Upgrade Plan",disabled:!1,className:"bg-cyan-500 text-white hover:bg-cyan-600 shadow-lg hover:shadow-cyan-500/40 transform hover:-translate-y-0.5"}:{text:"Contact Admin to Upgrade",disabled:!0,icon:s.jsx(F,{size:16,className:"mr-2"}),className:"bg-slate-200 dark:bg-slate-600/50 text-slate-600 dark:text-slate-300 cursor-not-allowed"};return s.jsx(a.div,{whileHover:c?{}:{y:-5},transition:{type:"spring",stiffness:300},className:"relative group flex flex-col rounded-2xl p-0.5 overflow-hidden transition-all duration-300 "+(l?"animated-border-bg":"bg-white/60 dark:bg-slate-800/50 border border-slate-200/70 dark:border-white/10"),children:s.jsxs("div",{className:"relative z-10 flex flex-col h-full rounded-[14px] p-8 text-center bg-white/80 dark:bg-slate-800/80 backdrop-blur-lg",children:[o&&s.jsxs("div",{className:"absolute top-4 right-4 text-xs font-bold text-white bg-gradient-to-r from-purple-500 to-indigo-500 px-3 py-1 rounded-full shadow-lg flex items-center gap-1",children:[s.jsx(S,{size:12,className:"fill-white"})," Popular"]}),s.jsxs("h3",{className:"text-2xl font-bold text-slate-800 dark:text-white flex items-center justify-center gap-2",children:[e.name,s.jsx("button",{onClick:()=>t(e),className:"text-slate-400 hover:text-cyan-500",children:s.jsx(F,{size:16})})]}),s.jsxs("div",{className:"my-8",children:[s.jsxs("div",{className:"flex items-baseline justify-center gap-1",children:[s.jsxs("span",{className:"text-5xl font-extrabold text-slate-900 dark:text-white tracking-tight",children:["₹",u.toFixed(0)]}),s.jsx("span",{className:"text-slate-500 dark:text-slate-400",children:b})]}),x&&m>0&&s.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:["Billed as ₹",p.toFixed(0)," per year."]})]}),s.jsx("ul",{className:"space-y-4 text-sm text-left flex-grow mb-8",children:e.description&&e.description.length>0?e.description.map(e=>s.jsxs("li",{className:"flex items-start",children:[s.jsx(U,{size:16,className:"text-green-500 mr-3 shrink-0 mt-0.5"}),s.jsx("span",{className:"text-slate-600 dark:text-slate-300",children:e})]},e)):s.jsx("li",{className:"flex items-start text-slate-500 italic",children:"Plan details available upon clicking."})}),s.jsxs("button",{onClick:()=>i(e),disabled:g.disabled,className:`w-full py-3 rounded-lg font-semibold text-lg flex items-center justify-center transition-all duration-300 ${g.className}`,children:[g.icon,g.text]})]})})},G=({icon:e,label:a,value:t})=>s.jsxs("li",{className:"flex justify-between items-center text-sm py-3 border-b border-slate-200 dark:border-slate-800 last:border-b-0",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[b.cloneElement(e,{size:18,className:"text-slate-400 dark:text-slate-500"}),s.jsx("span",{className:"text-slate-600 dark:text-slate-300",children:a})]}),s.jsx("span",{className:"font-semibold text-slate-800 dark:text-slate-100 flex items-center gap-1",children:t})]}),J=({plan:e,isOpen:l,onClose:r,pricingPeriod:i,annualDiscount:n})=>{if(!l||!e)return null;const d=e.priceMonthly,o=d>0?12*d*(1-n/100):0,c=d>0,x=[{key:"userLimit",icon:s.jsx(O,{}),label:"User Seats",value:-1===e.userLimit?"Unlimited":e.userLimit},{key:"exportsPerMonth",icon:s.jsx(D,{}),label:"Monthly Exports",value:-1===e.features.exportsPerMonth?"Unlimited":e.features.exportsPerMonth},{key:"templateAccessLevel",icon:s.jsx($,{}),label:"Template Access",value:`Level ${e.features.templateAccessLevel}`},{key:"batchActions",icon:s.jsx(R,{}),label:"Batch Actions",value:e.features.batchActions?s.jsx(U,{size:20,className:"text-green-500"}):s.jsx(N,{size:20,className:"text-red-500"})},{key:"watermarkRemoval",icon:s.jsx(L,{}),label:"Watermark Removal",value:e.features.watermarkRemoval?s.jsx(U,{size:20,className:"text-green-500"}):s.jsx(N,{size:20,className:"text-red-500"})}];return s.jsx(t,{children:s.jsxs("div",{className:"fixed inset-0 z-[102] flex items-center justify-center p-4",children:[s.jsx(a.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:r,className:"absolute inset-0 bg-black/70 backdrop-blur-md"}),s.jsxs(a.div,{initial:{scale:.95,y:20,opacity:0},animate:{scale:1,y:0,opacity:1},exit:{scale:.95,y:20,opacity:0},transition:{type:"spring",stiffness:300,damping:30},className:"relative z-10 w-full max-w-4xl max-h-[90vh] bg-white dark:bg-slate-900 rounded-2xl shadow-2xl flex flex-col border border-slate-200 dark:border-slate-800",children:[s.jsx("header",{className:"p-6 border-b border-slate-200 dark:border-slate-800 shrink-0",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-2xl font-bold text-slate-800 dark:text-white flex items-center gap-2",children:[s.jsx(p,{className:"text-cyan-500"})," ",e.name," Plan"]}),e.description&&s.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-sm mt-1",children:e.description[0]||"Complete feature set."})]}),s.jsx("button",{onClick:r,className:"p-2 rounded-full hover:bg-slate-200/70 dark:hover:bg-slate-700 transition-colors",children:s.jsx(N,{size:20,className:"text-slate-600 dark:text-slate-300"})})]})}),s.jsxs("main",{className:"p-6 md:p-8 flex-grow overflow-y-auto grid grid-cols-1 md:grid-cols-5 gap-8",children:[s.jsxs("div",{className:"md:col-span-3 flex flex-col gap-8",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-slate-700 dark:text-slate-200 mb-4",children:"What's Included"}),s.jsx("ul",{className:"space-y-3 text-sm",children:e.description&&e.description.map(e=>s.jsxs("li",{className:"flex items-start gap-3",children:[s.jsx(U,{size:16,className:"text-green-500 shrink-0 mt-0.5"}),s.jsx("span",{className:"text-slate-600 dark:text-slate-300",children:e})]},e))})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-slate-700 dark:text-slate-200 mb-4",children:"Plan Capabilities"}),s.jsx("ul",{className:"bg-slate-50 dark:bg-slate-800/50 rounded-xl p-4",children:x.map(e=>s.jsx(G,{...e},e.key))})]})]}),s.jsxs("div",{className:"md:col-span-2 bg-slate-100 dark:bg-slate-800/50 rounded-xl p-6 self-start",children:[s.jsx("h3",{className:"text-lg font-semibold text-slate-700 dark:text-slate-200 mb-4",children:"Pricing"}),s.jsxs("div",{className:"p-4 rounded-lg border border-slate-200 dark:border-slate-700",children:[s.jsx("div",{className:"font-bold text-slate-800 dark:text-slate-100",children:"Monthly"}),s.jsxs("div",{className:"text-3xl font-extrabold text-slate-900 dark:text-white mt-1",children:["₹",d.toFixed(0),c&&s.jsx("span",{className:"text-base font-medium text-slate-500 dark:text-slate-400",children:"/mo"})]})]}),c&&s.jsxs("div",{className:"mt-3 p-4 rounded-lg border border-slate-200 dark:border-slate-700",children:[s.jsxs("div",{className:"font-bold text-slate-800 dark:text-slate-100 flex justify-between items-center",children:["Annual",n>0&&s.jsxs("span",{className:"text-xs bg-red-500 text-white font-bold px-2 py-0.5 rounded-full",children:["SAVE ",n,"%"]})]}),s.jsxs("div",{className:"text-3xl font-extrabold text-slate-900 dark:text-white mt-1",children:["₹",(o/12).toFixed(0),s.jsx("span",{className:"text-base font-medium text-slate-500 dark:text-slate-400",children:"/mo"})]}),s.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:["Billed as ₹",o.toFixed(0)," per year"]})]})]})]})]})]})})},Q=({isOpen:e,onClose:l,plans:r,isCurrentPlan:i,onSelectPlan:n,userRole:d,pricingPeriod:o,annualDiscount:c})=>s.jsx(t,{children:e&&s.jsxs("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4",children:[s.jsx(a.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:l,className:"absolute inset-0 bg-black/70 backdrop-blur-md"}),s.jsxs(a.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"relative z-10 w-full max-w-6xl max-h-[90vh] bg-slate-100 dark:bg-slate-900 rounded-2xl shadow-2xl flex flex-col",children:[s.jsxs("header",{className:"flex items-center justify-between p-6 border-b border-slate-200 dark:border-slate-800 shrink-0",children:[s.jsx("h2",{className:"text-2xl font-bold text-slate-800 dark:text-white",children:"All Available Plans"}),s.jsx("button",{onClick:l,className:"p-2 rounded-full hover:bg-slate-200 dark:hover:bg-slate-700",children:s.jsx(N,{})})]}),s.jsx("main",{className:"p-8 overflow-y-auto",children:s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:r.map(e=>s.jsx(Z,{plan:e,isCurrent:i(e._id),onSelect:n,userRole:d,pricingPeriod:o,annualDiscount:c,isPopular:"Pro"===e.name,inModal:!0,onInfoClick:()=>{}},e._id))})})]})]})}),ee=()=>{const{user:t,subscriptionInfo:r,setSubscriptionInfo:i}=l(),{isDarkMode:b}=f(),[j,k]=e.useState([]),[y,v]=e.useState([]),[N,w]=e.useState(!0),[C,z]=e.useState(null),[P,A]=e.useState({isOpen:!1,items:[],context:null}),[S,M]=e.useState("monthly"),[U,O]=e.useState(!1),D=e.useRef(null),$="superadmin"===t?.role,[L,R]=e.useState({isOpen:!1,plan:null});e.useEffect(()=>{r?.paymentCycle&&M(r.paymentCycle)},[r]),e.useEffect(()=>{const e=D.current;if(!e)return;const s=s=>{const{clientX:a,clientY:t}=s,l=e.getBoundingClientRect();e.style.setProperty("--mouse-x",a-l.left+"px"),e.style.setProperty("--mouse-y",t-l.top+"px")};return e.addEventListener("mousemove",s),()=>e.removeEventListener("mousemove",s)},[N]);const F=e.useCallback(async()=>{if(t)try{w(!0);const e=await n({all:$}),s=await d();if(k(e.sort((e,s)=>e.displayOrder-s.displayOrder)),v(s),!$){const e=await o();i(e)}}catch(e){z(e.message||"An unexpected error occurred."),g.error("Could not load page data.")}finally{w(!1)}},[t,$,i]);e.useEffect(()=>{F()},[F]);const I=e=>{if("admin"!==t.role||$)return;const s="annual"===S,a=s?12*e.priceMonthly*.9:e.priceMonthly;R({isOpen:!1,plan:null}),A({isOpen:!0,items:[{itemType:"Plan",itemId:e._id,description:`Subscription: ${e.name} (${s?"Annual":"Monthly"})`,price:a,quantity:1}],context:{plan:e,period:S}})},B=e.useCallback(async()=>{const{context:e}=P,s=g.loading("Finalizing your new subscription...");try{return await c().catch(()=>null)?await x(e.plan._id,e.period):await m({planId:e.plan._id,billingPeriod:e.period}),g.success(`Successfully upgraded to the ${e.plan.name} plan!`,{id:s}),await F(),{success:!0}}catch(a){return g.error(a.message||"Upgrade failed. Please try again.",{id:s}),{success:!1,message:a.message}}},[F,P]),Y=e.useMemo(()=>j.slice(0,4),[j]);return N?s.jsx(K,{}):C?s.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-slate-50 dark:bg-slate-900",children:[s.jsx(E,{className:"w-16 h-16 text-red-500"}),s.jsx("h2",{className:"mt-4 text-2xl font-semibold",children:C})]}):s.jsxs("div",{className:"min-h-screen bg-slate-100 dark:bg-slate-950 font-sans text-slate-800 dark:text-slate-200 transition-colors duration-300",style:{backgroundImage:`\n      radial-gradient(circle at var(--mouse-x) var(--mouse-y), ${b?"rgba(6, 182, 212, 0.1)":"rgba(56, 189, 248, 0.15)"}, transparent 40vw),\n      linear-gradient(to bottom, transparent 85%, ${b?"#0f172a":"#f1f5f9"} 100%)\n    `,backgroundBlendMode:"normal"},children:[s.jsx("div",{className:"absolute inset-0 pointer-events-none",style:{backgroundImage:`radial-gradient(circle at var(--mouse-x) var(--mouse-y), ${b?"rgba(6, 182, 212, 0.08)":"rgba(56, 189, 248, 0.1)"}, transparent 40vw)`}}),s.jsx(h,{position:"top-center",toastOptions:{duration:4e3,className:"dark:bg-slate-700 dark:text-white"}}),s.jsx("div",{className:"relative z-10 p-4 sm:p-6 md:p-8",children:s.jsxs("div",{className:"w-full mx-auto space-y-12",children:[s.jsxs(a.header,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(p,{size:44,className:"text-cyan-500 dark:text-cyan-400"}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-4xl font-bold tracking-tight text-slate-900 dark:text-white",children:"Subscriptions & Plans"}),s.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-1",children:"Choose the perfect plan for your needs and collaborators."})]})]}),$&&s.jsxs("button",{onClick:()=>g.info("Create plan modal would open here."),className:"group shrink-0 relative inline-flex items-center justify-center px-6 py-3 text-sm font-bold text-slate-900 dark:text-white bg-white/70 dark:bg-cyan-500/10 border border-slate-200 dark:border-cyan-500/30 rounded-lg shadow-lg hover:bg-white dark:hover:bg-cyan-500/20 hover:text-cyan-600 dark:hover:text-cyan-300 transition-all transform hover:scale-105",children:[s.jsx("span",{className:"absolute -inset-0.5 -z-10 bg-gradient-to-br from-cyan-400 to-blue-600 rounded-lg blur opacity-20 group-hover:opacity-40"}),s.jsx(_,{size:18,className:"mr-2 transition-transform group-hover:rotate-90"}),"Create New Plan"]})]}),s.jsx(a.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{delay:.1},className:"flex justify-center",children:s.jsx(X,{period:S,onToggle:M})}),s.jsx(a.div,{initial:"hidden",animate:"visible",variants:{hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.07}}},className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 pt-6",children:Y.map(e=>s.jsx(Z,{plan:e,isCurrent:r?.plan?._id===e._id,isPopular:"Pro"===e.name,onSelect:I,userRole:t.role,pricingPeriod:S,annualDiscount:10,onInfoClick:()=>R({isOpen:!0,plan:e})},e._id))}),j.length>4&&s.jsx(a.div,{className:"text-center",children:s.jsx("button",{onClick:()=>O(!0),className:"font-semibold text-lg text-cyan-600 dark:text-cyan-400 hover:underline transition-all hover:text-cyan-500",children:"View All Plans →"})}),y.length>0&&s.jsx(W,{users:y,onUsersUpdate:e=>v(e)})]})}),s.jsx(J,{plan:L.plan,isOpen:L.isOpen,onClose:()=>R({isOpen:!1,plan:null}),pricingPeriod:S,annualDiscount:10}),s.jsx(Q,{isOpen:U,onClose:()=>O(!1),plans:j,isCurrentPlan:e=>r?.plan?._id===e,onSelectPlan:I,userRole:t.role,pricingPeriod:S,annualDiscount:10}),s.jsx(T,{isOpen:P.isOpen,onClose:()=>A({isOpen:!1,items:[],context:null}),items:P.items,onPaymentHandle:B,onValidateCoupon:async(e,s)=>u(e,s)}),s.jsx("style",{children:"@keyframes card-fade-in { to { opacity: 1; transform: translateY(0); } } .animate-card-fade-in { opacity: 0; transform: translateY(20px); animation: card-fade-in 0.8s ease-out forwards; } @property --angle { syntax: '<angle>'; inherits: false; initial-value: 0deg; } .animated-border-bg { position: relative; background-image: padding-box, linear-gradient(var(--angle), #06b6d4, #3b82f6, #8b5cf6, #ec4899); animation: 5s rotate linear infinite; } .animated-border-bg::before { content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; z-index: -1; margin: -2px; border-radius: inherit; background: linear-gradient(var(--angle), #06b6d4, #3b82f6, #8b5cf6, #ec4899); animation: 5s rotate linear infinite; } @keyframes rotate { to { --angle: 360deg; } }"})]})};export{ee as default};
